

<!DOCTYPE html>
<html class="writer-html5" lang="fr" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>interface_graphique.main_interface_graphique &mdash; Documentation En-visage 0.0.1</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5cd26065"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/translations.js?v=e6b791cb"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Recherche" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            En-visage
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" aria-label="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contenu de la documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Modules.html">Modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">En-visage</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Code du module</a></li>
      <li class="breadcrumb-item active">interface_graphique.main_interface_graphique</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Code source de interface_graphique.main_interface_graphique</h1><div class="highlight"><pre>
<span></span><span class="c1">#Import des librairies PyQt6</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PyQt6.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">QApplication</span><span class="p">,</span> <span class="n">QWidget</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QFrame</span><span class="p">,</span> <span class="n">QGraphicsDropShadowEffect</span><span class="p">,</span> <span class="n">QGridLayout</span><span class="p">,</span> <span class="n">QHBoxLayout</span><span class="p">,</span> <span class="n">QSpacerItem</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="p">,</span> <span class="n">QGraphicsDropShadowEffect</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="p">,</span> <span class="n">QScrollArea</span><span class="p">,</span> <span class="n">QFileDialog</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PyQt6.QtGui</span><span class="w"> </span><span class="kn">import</span> <span class="n">QFont</span><span class="p">,</span> <span class="n">QPixmap</span><span class="p">,</span> <span class="n">QColor</span><span class="p">,</span> <span class="n">QFontDatabase</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">,</span> <span class="n">QPalette</span><span class="p">,</span> <span class="n">QFont</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PyQt6.QtCore</span><span class="w"> </span><span class="kn">import</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">QTimer</span><span class="p">,</span> <span class="n">QSize</span><span class="p">,</span> <span class="n">QPropertyAnimation</span><span class="p">,</span> <span class="n">QEasingCurve</span><span class="p">,</span> <span class="n">pyqtSignal</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;..&#39;</span><span class="p">)))</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">share</span>


<span class="c1">#######  WELCOME SCREEN ###########</span>
<div class="viewcode-block" id="WelcomeScreen">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.WelcomeScreen">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">WelcomeScreen</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Application home screen.</span>

<span class="sd">    This class displays a home screen with an animated neon text effect.</span>
<span class="sd">    It can be used to trigger the tutorial display, switch to the application&#39;s main screen or quit the application.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Initializes home screen components. &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">()</span>

<div class="viewcode-block" id="WelcomeScreen.animate_neon">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.WelcomeScreen.animate_neon">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">animate_neon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Animates the neon text effect by randomly varying the brightness.</span>
<span class="sd">        This effect simulates a neon light that flickers or flickers irregularly. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">rd</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">:</span>  <span class="c1"># 20% chance of a longer pause (temporary extinction) for a flashing effect</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">brightness</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">80</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">brightness</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>  <span class="c1"># Luminosity variation</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">shadow</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brightness</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">brightness</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">brightness</span><span class="p">))</span>  <span class="c1"># Apply the white color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_random_blinking</span><span class="p">()</span>  <span class="c1"># Relaunch with a new random time</span></div>


<div class="viewcode-block" id="WelcomeScreen.start_random_blinking">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.WelcomeScreen.start_random_blinking">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">start_random_blinking</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Starts a new animation with a random delay. The delay is between 50 and 400 ms. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">rd</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">400</span><span class="p">))</span>  <span class="c1"># Random change between 50ms and 400ms</span></div>


<div class="viewcode-block" id="WelcomeScreen.start_main_screen">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.WelcomeScreen.start_main_screen">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">start_main_screen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Switches to the application&#39;s main screen. </span>
<span class="sd">            Creates an instance of MainScreen, displays it and closes the home screen. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_screen</span> <span class="o">=</span> <span class="n">MainScreen</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_screen</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="WelcomeScreen.start_zoom_animation">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.WelcomeScreen.start_zoom_animation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">start_zoom_animation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Launches a looping zoom-in/zoom-out animation on the text &#39;WELCOME!</span>
<span class="sd">            The `label` label is enlarged up to 1.2x, then reduced, with a fluid effect. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_animation</span> <span class="o">=</span> <span class="n">QPropertyAnimation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;scale&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_animation</span><span class="o">.</span><span class="n">setDuration</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>  <span class="c1"># Zoom animation duration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_animation</span><span class="o">.</span><span class="n">setStartValue</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Initial size (normal)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_animation</span><span class="o">.</span><span class="n">setEndValue</span><span class="p">(</span><span class="mf">1.2</span><span class="p">)</span>  <span class="c1"># Increased size (zoom)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_animation</span><span class="o">.</span><span class="n">setLoopCount</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Repeats animation indefinitely</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_animation</span><span class="o">.</span><span class="n">setEasingCurve</span><span class="p">(</span><span class="n">QEasingCurve</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">InOutQuad</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">zoom_animation</span><span class="o">.</span><span class="n">start</span><span class="p">()</span></div>


<div class="viewcode-block" id="WelcomeScreen.initUI">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.WelcomeScreen.initUI">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Initializes the graphical interface of the home screen.</span>

<span class="sd">            Configures window, background image, ‘WELCOME!’ animated text with neon effect, buttons (‘Start’, ‘Tutorial’, ‘Exit’) and launches animations. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Welcome&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>

        <span class="c1"># Background image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">pixmap</span> <span class="o">=</span> <span class="n">QPixmap</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span><span class="s2">&quot;image_de_fond.png&quot;</span><span class="p">))</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">pixmap</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">setScaledContents</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>

        <span class="c1"># Creating the main layout</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>

        <span class="c1"># &#39;Welcome&#39; text with neon effect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;WELCOME !&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Press Start 2P&quot;</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="n">QFont</span><span class="o">.</span><span class="n">Weight</span><span class="o">.</span><span class="n">Bold</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color : white;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setFixedHeight</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>  

        <span class="c1"># Neon effet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shadow</span> <span class="o">=</span> <span class="n">QGraphicsDropShadowEffect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shadow</span><span class="o">.</span><span class="n">setBlurRadius</span><span class="p">(</span><span class="mi">70</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">shadow</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">shadow</span><span class="o">.</span><span class="n">setOffset</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> 

        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setGraphicsEffect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shadow</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>

        <span class="c1"># &#39;Welcome&#39; text with neon effectFlashing neon animation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">brightness</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">brightness_direction</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">animate_neon</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_random_blinking</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>

        <span class="c1"># Button CSS styling</span>
        <span class="n">button_style</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QPushButton {</span>
<span class="s2">                color: white;</span>
<span class="s2">                font-size: 17px;</span>
<span class="s2">                border: 2px solid red;  /* Contour rouge */</span>
<span class="s2">                border-radius: 20px;</span>
<span class="s2">                padding: 5px 20px;</span>
<span class="s2">                background-color: transparent;</span>
<span class="s2">            }</span>
<span class="s2">            QPushButton:hover {</span>
<span class="s2">                background-color: rgba(255, 0, 0, 0.2); /* Rouge translucide au survol */</span>
<span class="s2">            }</span>
<span class="s2">        &quot;&quot;&quot;</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addSpacing</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> 

        <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Start&quot;</span><span class="p">,</span> <span class="s2">&quot;Tutorial&quot;</span><span class="p">,</span> <span class="s2">&quot;Exit&quot;</span><span class="p">]:</span>
            <span class="n">button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="n">button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">button_style</span><span class="p">)</span>
            <span class="n">button</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
            <span class="n">button</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;8_bit_1_6&quot;</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">button</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">text</span> <span class="o">==</span> <span class="s2">&quot;Exit&quot;</span><span class="p">:</span>
                <span class="n">button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">text</span> <span class="o">==</span> <span class="s2">&quot;Start&quot;</span><span class="p">:</span>
                <span class="n">button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_main_screen</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">text</span> <span class="o">==</span> <span class="s2">&quot;Tutorial&quot;</span><span class="p">:</span>
                <span class="n">button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_tutorial</span><span class="p">)</span>  <span class="c1"># Adding the connection to display the tutorial</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addSpacing</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  

        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">start_zoom_animation</span><span class="p">()</span></div>


<div class="viewcode-block" id="WelcomeScreen.resizeEvent">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.WelcomeScreen.resizeEvent">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">resizeEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Automatically resizes the background image when the window is resized. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">())</span></div>

    
<div class="viewcode-block" id="WelcomeScreen.show_tutorial">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.WelcomeScreen.show_tutorial">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">show_tutorial</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Open the tutorial &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tutorial_popup</span> <span class="o">=</span> <span class="n">UndertaleDialog</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tutorial_popup</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
</div>



<span class="c1">####### TUTORIAL ###########    </span>
<div class="viewcode-block" id="UndertaleDialog">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.UndertaleDialog">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">UndertaleDialog</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Undertale-style tutorial window.</span>

<span class="sd">    Displays a series of messages guiding the user through the interface, with a progressive text effect, a blinking cursor, an &quot;OK&quot; button to move on to the next message, and a progressive appearance animation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Initializes the tutorial window.</span>
<span class="sd">            Prepares dialogs to be displayed, initializes text variables, configures the user interface and launches the pop-up animation. &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialogs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;* Welcome to the tutorial!</span><span class="se">\n</span><span class="s2">Learn how to use this interface step by step.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;* First, click on images to select them.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;* Now you have to make a choice&quot;</span><span class="p">,</span>
            <span class="s2">&quot;* Press &#39;Combine&#39; to mix them!&quot;</span><span class="p">,</span>
            <span class="s2">&quot;* Or press “Generate” if you wish to create a variant.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;* Once you&#39;re satisfied with the portraits presented, click &#39;Finish&#39; to validate.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;* Now, you&#39;re ready to start! Good luck!&quot;</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog_index</span> <span class="o">=</span> <span class="mi">0</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">full_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialogs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dialog_index</span><span class="p">]</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">current_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">text_index</span> <span class="o">=</span> <span class="mi">0</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">show_cursor</span> <span class="o">=</span> <span class="kc">False</span>  

        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowOpacity</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">start_fade_in_animation</span><span class="p">()</span>  

<div class="viewcode-block" id="UndertaleDialog.initUI">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.UndertaleDialog.initUI">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Configures the tutorial&#39;s graphical interface.</span>
<span class="sd">            Initializes title, dialog frame, animated text, &quot;OK&quot; button, and timers for progressive text display and cursor blinking. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Tutorial&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: black;&quot;</span><span class="p">)</span>  

        <span class="c1"># Add title &quot;TUTORIAL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;TUTORIAL&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_label</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Eight-Bit Madness&quot;</span><span class="p">,</span> <span class="mi">24</span><span class="p">))</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">title_label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: white; border: none;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_label</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_label</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">550</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>  

        <span class="c1"># Framework for dialogue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog_frame</span> <span class="o">=</span> <span class="n">QFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog_frame</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: black; border: 2px solid white;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog_frame</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">550</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

        <span class="c1"># Text to be displayed in the frame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dialog_frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: white; border: none;&quot;</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">text_label</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Eight-Bit Madness&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_label</span><span class="o">.</span><span class="n">setWordWrap</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_label</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>  

        <span class="c1"># &#39;OK&#39; button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ok_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialog_frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ok_button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span>
            <span class="s2">&quot;color: white; background-color: transparent; border: 2px solid white; padding: 2px;&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ok_button</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Eight-Bit Madness&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ok_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">460</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">ok_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">next_dialog</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ok_button</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>  

        <span class="bp">self</span><span class="o">.</span><span class="n">text_timer</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cursor_timer</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cursor_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blink_cursor</span><span class="p">)</span></div>


<div class="viewcode-block" id="UndertaleDialog.start_fade_in_animation">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.UndertaleDialog.start_fade_in_animation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">start_fade_in_animation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Starts a progressive window animation.</span>
<span class="sd">             Gradually increases opacity until the window is fully visible. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opacity</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fade_timer</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fade_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">increase_opacity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fade_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span></div>


<div class="viewcode-block" id="UndertaleDialog.increase_opacity">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.UndertaleDialog.increase_opacity">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">increase_opacity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Gradually increases window opacity.</span>
<span class="sd">            Increments opacity until it reaches 1, then stops the animation timer. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">opacity</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">opacity</span> <span class="o">+=</span> <span class="mf">0.1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setWindowOpacity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opacity</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fade_timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span></div>


<div class="viewcode-block" id="UndertaleDialog.update_text">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.UndertaleDialog.update_text">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Gradually displays text letter by letter in the dialog box.</span>
<span class="sd">            Once the complete text is displayed, the cursor starts flashing and the &quot;OK&quot; button becomes visible.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_text</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_text</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_text</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">text_index</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_text</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text_index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text_timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cursor_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>  
            <span class="bp">self</span><span class="o">.</span><span class="n">ok_button</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  </div>


<div class="viewcode-block" id="UndertaleDialog.blink_cursor">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.UndertaleDialog.blink_cursor">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">blink_cursor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Flashes a “_” cursor at the end of the displayed text.</span>
<span class="sd">            Toggles between display with or without cursor every 500 ms. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cursor</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_text</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_cursor</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_cursor</span></div>


<div class="viewcode-block" id="UndertaleDialog.next_dialog">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.UndertaleDialog.next_dialog">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">next_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Goes to the next message in the tutorial, or closes the window if there are none left.</span>
<span class="sd">            Resets text display and restarts letter-by-letter animation. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cursor_timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">ok_button</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>  

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialog_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dialogs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dialog_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">full_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialogs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dialog_index</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text_index</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">text_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  
            <span class="bp">self</span><span class="o">.</span><span class="n">text_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>  
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>    </div>
</div>


<span class="c1">#######  START SCREEN ###########</span>
<div class="viewcode-block" id="MainScreen">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.MainScreen">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">MainScreen</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class representing the start screen of the application.</span>

<span class="sd">    This window allows the user to:</span>
<span class="sd">    - View 20 random images from a temporary folder.</span>
<span class="sd">    - Select one or more images.</span>
<span class="sd">    - Choose between two actions: &#39;GENERATE&#39; (to generate a new image) or &#39;COMBINE&#39; (to merge several images).</span>
<span class="sd">    - Launch a process based on the selected images.</span>
<span class="sd">    - Regenerate a new set of images.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        open_windows (list): List of open secondary windows.</span>
<span class="sd">        tmp (str): Path to the &#39;tmp&#39; folder containing the images.</span>
<span class="sd">        image_paths (list): List of file paths to the displayed images.</span>
<span class="sd">        selected_images (list): List of images selected by the user.</span>
<span class="sd">        selection_mode (str): Image selection mode (&quot;combine&quot; or &quot;generate&quot;).</span>
<span class="sd">    &quot;&quot;&quot;</span>
     
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the main screen&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">open_windows</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List to store opened secondary windows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Selection of images&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: black;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;tmp&quot;</span><span class="p">))</span>

        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Title label at the top</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;   Please, select at least one image :   &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Press Start 2P&quot;</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="n">QFont</span><span class="o">.</span><span class="n">Weight</span><span class="o">.</span><span class="n">Bold</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: white;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>

        <span class="c1"># Grid layout to display image thumbnails</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid_layout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid_layout</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

        <span class="c1"># Prepare placeholder paths for 20 images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image_paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tmp</span><span class="p">,</span><span class="sa">f</span><span class="s2">&quot;img</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span> <span class="o">=</span> <span class="mi">150</span> <span class="c1"># Size for displayed thumbnails</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">row</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="c1"># Grid coordinates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image_labels</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List to keep track of QLabel widgets showing the images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># Currently selected images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_mode</span> <span class="o">=</span> <span class="s2">&quot;combine&quot;</span>  <span class="c1"># Default mode</span>

        <span class="c1"># Load and display images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_images</span><span class="p">()</span>

        <span class="c1"># Add title and grid to layout</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_layout</span><span class="p">)</span>

        <span class="c1"># Add spacing between the grid and buttons</span>
        <span class="n">spacer_item</span> <span class="o">=</span> <span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Policy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Policy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addSpacerItem</span><span class="p">(</span><span class="n">spacer_item</span><span class="p">)</span>

        <span class="c1"># Add action buttons (COMBINE, GENERATE, EXIT, etc.)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_buttons</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>

        <span class="c1"># Set final layout for the widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>

<div class="viewcode-block" id="MainScreen.load_images">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.MainScreen.load_images">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">load_images</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads 20 random images into the &#39;grid_layout&#39; from the &#39;tmp&#39; folder.&quot;&quot;&quot;</span>
        <span class="n">img_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmp</span>

        <span class="c1"># Check that the folder exists</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">img_folder</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The file </span><span class="si">{</span><span class="n">img_folder</span><span class="si">}</span><span class="s2"> doesn&#39;t exist.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="c1"># Get all image files from the folder</span>
        <span class="n">all_images</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">img_folder</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span> <span class="s1">&#39;.png&#39;</span><span class="p">))]</span>
        
        <span class="c1"># Check if there are at least 20 images available</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_images</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Not enough images in the folder.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Select the 20 images in the tmp folder </span>
        <span class="c1">#self.image_paths = rd.sample(all_images, 20)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image_paths</span> <span class="o">=</span> <span class="n">all_images</span>
        
        <span class="c1"># Clear previous images from the layout</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_layout</span><span class="o">.</span><span class="n">count</span><span class="p">())):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grid_layout</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">deleteLater</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">image_labels</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Reset image labels list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Reset selected images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">row</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>  <span class="c1"># Reset grid position</span>

        <span class="c1"># Display selected images in the grid</span>
        <span class="k">for</span> <span class="n">image_file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_paths</span><span class="p">:</span>
            <span class="n">image_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">img_folder</span><span class="p">,</span> <span class="n">image_file</span><span class="p">)</span>

            <span class="n">image_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">pixmap</span> <span class="o">=</span> <span class="n">QPixmap</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>
            <span class="n">pixmap</span> <span class="o">=</span> <span class="n">pixmap</span><span class="o">.</span><span class="n">scaled</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_size</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AspectRatioMode</span><span class="o">.</span><span class="n">KeepAspectRatio</span><span class="p">)</span>
            <span class="n">image_label</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">pixmap</span><span class="p">)</span>
            <span class="n">image_label</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
            <span class="n">image_label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;border: 2px solid white;&quot;</span><span class="p">)</span>

            <span class="c1"># Assign a mouse click handler to allow image selection</span>
            <span class="n">image_label</span><span class="o">.</span><span class="n">mousePressEvent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_image_click_handler</span><span class="p">(</span><span class="n">image_label</span><span class="p">)</span>

            <span class="c1"># Add image to the grid layout</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grid_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">image_label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">row</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">col</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">image_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image_label</span><span class="p">)</span>

            <span class="c1"># Update grid position</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">col</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">col</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">col</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="MainScreen.create_image_click_handler">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.MainScreen.create_image_click_handler">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_image_click_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_label</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a click handler function for a given image&quot;&quot;&quot;</span>
        
        <span class="k">def</span><span class="w"> </span><span class="nf">on_image_click</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
            <span class="c1"># Toggle selection state when the image is clicked</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toggle_image_selection</span><span class="p">(</span><span class="n">image_label</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">on_image_click</span></div>


<div class="viewcode-block" id="MainScreen.toggle_image_selection">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.MainScreen.toggle_image_selection">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">toggle_image_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_label</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects or deselects an image based on its current state.</span>
<span class="sd">        The image&#39;s state is visually changed by modifying its border color.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;combine&quot;</span><span class="p">:</span>
            <span class="c1"># In &quot;combine&quot; mode: allow multiple images to be selected</span>
            <span class="k">if</span> <span class="n">image_label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">image_label</span><span class="p">)</span>
                <span class="n">image_label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;border: 2px solid white;&quot;</span><span class="p">)</span>  <span class="c1"># Deselect: revert to white border</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image_label</span><span class="p">)</span>
                <span class="n">image_label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;border: 2px solid red;&quot;</span><span class="p">)</span>    <span class="c1"># Select: apply red border</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_mode</span> <span class="o">==</span> <span class="s2">&quot;generate&quot;</span><span class="p">:</span>
            <span class="c1"># In &quot;generate&quot; mode: only allow one image to be selected at a time</span>
            <span class="k">if</span> <span class="n">image_label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image_label</span><span class="p">)</span>
                <span class="n">image_label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;border: 2px solid red;&quot;</span><span class="p">)</span>    <span class="c1"># Select: apply red border</span>
            <span class="k">elif</span> <span class="n">image_label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">image_label</span><span class="p">)</span>
                <span class="n">image_label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;border: 2px solid white;&quot;</span><span class="p">)</span>  <span class="c1"># Deselect: revert to white border</span>

        <span class="c1"># Update the state of the action buttons based on the current selection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_buttons_state</span><span class="p">()</span></div>


<div class="viewcode-block" id="MainScreen.update_buttons_state">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.MainScreen.update_buttons_state">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_buttons_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enables or disables the buttons based on the number of selected images.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># If more than one image is selected, allow the &#39;combine&#39; action</span>
            <span class="c1"># but disable the &#39;generate&#39; button</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generate_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combine_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># If exactly one image is selected, allow the &#39;generate&#39; action</span>
            <span class="c1"># but disable the &#39;combine&#39; button</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generate_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combine_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If no images are selected, disable both the &#39;generate&#39; and &#39;combine&#39; buttons</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generate_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combine_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>



<div class="viewcode-block" id="MainScreen.get_image_path_from_qlabel">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.MainScreen.get_image_path_from_qlabel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_image_path_from_qlabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_label</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the absolute path of the image associated with a QLabel.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Search in the list of labels to find the associated path</span>
        <span class="n">image_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_labels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">image_label</span><span class="p">)</span>
        <span class="n">image_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_paths</span><span class="p">[</span><span class="n">image_index</span><span class="p">]</span>
        
        <span class="c1"># Return the absolute path by joining with the base directory</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tmp</span><span class="p">,</span> <span class="n">image_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="MainScreen.on_generate_button_click">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.MainScreen.on_generate_button_click">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_generate_button_click</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the process of generating a new image.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="p">:</span>
            <span class="c1"># Get the absolute paths of the selected images</span>
            <span class="n">selected_paths</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_image_path_from_qlabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="p">]</span>

            <span class="c1"># Call the function with the image paths</span>
            <span class="n">share</span><span class="o">.</span><span class="n">generate_img</span><span class="p">(</span><span class="n">selected_paths</span><span class="p">)</span>

            <span class="c1"># Open a new workspace window with the selected images and temporary directory</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="n">PortraitWorkspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmp</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="MainScreen.on_combine_button_click">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.MainScreen.on_combine_button_click">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_combine_button_click</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the process of combining images.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="p">:</span>
            <span class="c1"># Get the absolute paths of the selected images</span>
            <span class="n">selected_paths</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_image_path_from_qlabel</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="p">]</span>
            
            <span class="c1"># Call the function with the image paths</span>
            <span class="n">share</span><span class="o">.</span><span class="n">combine_img</span><span class="p">(</span><span class="n">selected_paths</span><span class="p">)</span>
            
            <span class="c1"># Open a new workspace window with the selected images and temporary directory</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="n">PortraitWorkspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmp</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="MainScreen.add_buttons">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.MainScreen.add_buttons">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layout</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Ajoute les boutons d&#39;action (COMBINE, GENERATE, EXIT, REGENERATE) &quot;&quot;&quot;</span>
        <span class="n">button_style</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QPushButton {</span>
<span class="s2">                color: white;</span>
<span class="s2">                font-size: 17px;</span>
<span class="s2">                border: 2px solid red;</span>
<span class="s2">                border-radius: 20px;</span>
<span class="s2">                padding: 5px 20px;</span>
<span class="s2">                background-color: transparent;</span>
<span class="s2">            }</span>
<span class="s2">            QPushButton:hover {</span>
<span class="s2">                background-color: rgba(255, 0, 0, 0.2);</span>
<span class="s2">            }</span>
<span class="s2">            QPushButton:disabled {</span>
<span class="s2">                color: grey;</span>
<span class="s2">                border-color: grey;</span>
<span class="s2">                background-color: #333;</span>
<span class="s2">            }</span>
<span class="s2">        &quot;&quot;&quot;</span>

        <span class="n">button_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>

        <span class="n">button_layout</span><span class="o">.</span><span class="n">addSpacerItem</span><span class="p">(</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Policy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Policy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">combine_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;COMBINE&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combine_button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">button_style</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combine_button</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combine_button</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;8_bit_1_6&quot;</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combine_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combine_button</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">generate_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;GENERATE&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generate_button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">button_style</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generate_button</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generate_button</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;8_bit_1_6&quot;</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generate_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generate_button</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">generate_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_generate_button_click</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">combine_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_combine_button_click</span><span class="p">)</span>  

        <span class="n">exit_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;BACK TO START&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">exit_button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">button_style</span><span class="p">)</span>
        <span class="n">exit_button</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="n">exit_button</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;8_bit_1_6&quot;</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
        <span class="n">exit_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_exit_button_click</span><span class="p">)</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">exit_button</span><span class="p">)</span>

        <span class="c1"># Add the &quot;Regenerate&quot; icon in the same horizontal layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_button</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span>
            <span class="n">QIcon</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span><span class="s2">&quot;icone1.png&quot;</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_button</span><span class="o">.</span><span class="n">setIconSize</span><span class="p">(</span><span class="n">QSize</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">))</span>  <span class="c1"># Taille de l&#39;icône</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;border: none; background-color: transparent;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_button</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regenerate_images</span><span class="p">)</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regenerate_button</span><span class="p">)</span>

        <span class="c1"># Spacer after the buttons to center them</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addSpacerItem</span><span class="p">(</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Policy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Policy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">))</span>

        <span class="c1"># Add the buttons to the main window</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">button_layout</span><span class="p">)</span></div>


<div class="viewcode-block" id="MainScreen.regenerate_images">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.MainScreen.regenerate_images">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">regenerate_images</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Regenerates a new selection of 20 random images from the &#39;data&#39; folder and resets the selection.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Regenerating images...&quot;</span><span class="p">)</span>

        <span class="c1"># Clear the list of selected images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="c1"># Remove all current images from the grid_layout</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_layout</span><span class="o">.</span><span class="n">count</span><span class="p">())):</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_layout</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">widget</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">widget</span><span class="o">.</span><span class="n">deleteLater</span><span class="p">()</span>  <span class="c1"># Remove the widget (image label) from the layout</span>

        <span class="c1">#clear the tmp folder and upload 20 new images from the data folder</span>
        <span class="n">share</span><span class="o">.</span><span class="n">clear_tmp</span><span class="p">()</span>
        <span class="n">share</span><span class="o">.</span><span class="n">replace_20_first_img_in_directory</span><span class="p">()</span>

        <span class="c1"># Reload 20 new random images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_images</span><span class="p">()</span>

        <span class="c1"># Update the state of the buttons based on the new selection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_buttons_state</span><span class="p">()</span></div>

        
<div class="viewcode-block" id="MainScreen.on_exit_button_click">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.MainScreen.on_exit_button_click">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_exit_button_click</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Closes the current window and returns to the welcome screen (WelcomeScreen).&quot;&quot;&quot;</span>

        <span class="c1">#clear tmp and add 20 new images from data </span>
        <span class="n">share</span><span class="o">.</span><span class="n">clear_tmp</span><span class="p">()</span>
        <span class="n">share</span><span class="o">.</span><span class="n">replace_20_first_img_in_directory</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">welcome_screen</span> <span class="o">=</span> <span class="n">WelcomeScreen</span><span class="p">()</span>  <span class="c1"># Create a new instance of WelcomeScreen</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">welcome_screen</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># Show the welcome screen</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Close the current window</span></div>
</div>




<span class="c1">##### PORTRAIT WORKSPACE ######</span>
<div class="viewcode-block" id="PortraitWorkspace">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.PortraitWorkspace">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PortraitWorkspace</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A workspace for displaying and interacting with generated portraits.</span>

<span class="sd">    This class allows the user to interact with a set of generated portraits by selecting them, generating new images, combining images, and viewing the result on the final screen.</span>
<span class="sd">    The screen shows the generated portraits of the genetic algorithm and the whole history of previous selected images.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        tmp (str): The path to the directory containing the images.</span>
<span class="sd">        genetic_portraits (dict): A dictionary storing the last 4 generated portraits with their respective QIcons and QPushButtons.</span>
<span class="sd">        history_buttons (dict): A dictionary of previously selected portrait buttons for quick access.</span>
<span class="sd">        generated_buttons (list): A list of QPushButtons created for the portraits.</span>
<span class="sd">        selected_images (list): A list of selected portraits as QPushButtons.</span>
<span class="sd">        selected_buttons (list): A list of selected portrait buttons for quick access.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected_images</span><span class="p">,</span> <span class="n">tmp</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span>  <span class="c1"># Path to the tmp folder where images are stored</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">genetic_portraits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_last_images</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>  <span class="c1"># Dict to get the last 4 portraits generated by the genetic algorithm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_buttons</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Selective history; if an image isn&#39;t already in the history, add it.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generated_buttons</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Holds all the buttons generated from selected images</span>
        
        <span class="c1"># List of images selected by the user</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">selected_images</span><span class="p">)</span>  <span class="c1"># A global history of selected images, storing all selected images</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_buttons</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List to store buttons associated with selected images</span>
        
        <span class="c1"># Initialize the user interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">()</span>

    
<div class="viewcode-block" id="PortraitWorkspace.get_last_images">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.PortraitWorkspace.get_last_images">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_last_images</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmp</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetches the last 4 images from the &#39;tmp&#39; folder in the form of a dictionary {QIcon: QPushButton}.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">extract_index</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;img(\d+)\.jpg&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">if</span> <span class="n">match</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tmp</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Image introuvable&quot;</span><span class="p">)</span>

        <span class="n">valid_ext</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;.jpeg&#39;</span><span class="p">)</span>
        <span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">valid_ext</span><span class="p">)</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">)]</span>
        <span class="n">images</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">images</span><span class="p">,</span><span class="n">key</span> <span class="o">=</span> <span class="n">extract_index</span><span class="p">,</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">4</span><span class="p">]</span>  <span class="c1"># Select the last 4 elements of the list </span>

        <span class="n">genetic_portraits</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># Create a dictionary with QIcon as the key and QPushButton as the value</span>
        <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span> 
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span> 
            <span class="n">pixmap</span> <span class="o">=</span> <span class="n">QPixmap</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="c1"># Create a QPixmap object from the image file</span>
            <span class="n">icon</span> <span class="o">=</span> <span class="n">QIcon</span><span class="p">(</span><span class="n">pixmap</span><span class="p">)</span> <span class="c1"># Create a QIcon object from the QPixmap</span>
            <span class="n">btn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_image_button</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span> <span class="c1"># Create a QPushButton with the QIcon</span>
            <span class="n">btn</span><span class="o">.</span><span class="n">image_path</span> <span class="o">=</span> <span class="n">path</span> <span class="c1"># Store the image path in the button</span>
            <span class="n">genetic_portraits</span><span class="p">[</span><span class="n">btn</span><span class="p">]</span> <span class="o">=</span> <span class="n">icon</span>  <span class="c1"># Add the button to the dictionary, with QIcon as the value</span>

        <span class="k">return</span> <span class="n">genetic_portraits</span> <span class="c1"># Return the dictionary containing the 4 most recent images</span></div>


<div class="viewcode-block" id="PortraitWorkspace.initUI">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.PortraitWorkspace.initUI">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Set window title and geometry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Portrait Workspace&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">900</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: black;&quot;</span><span class="p">)</span>

        <span class="c1"># Create the main layout and sub-layouts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">main_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generated_layout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>

        <span class="c1"># History selection layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_layout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignTop</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignLeft</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_layout</span><span class="o">.</span><span class="n">setHorizontalSpacing</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_layout</span><span class="o">.</span><span class="n">setVerticalSpacing</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># History label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;  Selection history  &quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            color: white;</span>
<span class="s2">            font-size: 16px;</span>
<span class="s2">            font-weight: bold;</span>
<span class="s2">            font-family: &#39;Pixel Operator Mono&#39;;</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>

        <span class="c1"># Scroll area</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll_area</span> <span class="o">=</span> <span class="n">QScrollArea</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll_area</span><span class="o">.</span><span class="n">setWidgetResizable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll_area</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        QScrollArea {</span>
<span class="s2">            border: none;</span>
<span class="s2">            background-color: black;</span>
<span class="s2">        }</span>
<span class="s2">        QScrollBar:vertical {</span>
<span class="s2">            background: black;</span>
<span class="s2">            width: 14px;</span>
<span class="s2">            margin: 0px;</span>
<span class="s2">        }</span>
<span class="s2">        QScrollBar::handle:vertical {</span>
<span class="s2">            background: rgba(255, 255, 255, 120);  /* blanc semi-transparent */</span>
<span class="s2">            min-height: 20px;</span>
<span class="s2">            border-radius: 7px;</span>
<span class="s2">        }</span>
<span class="s2">        QScrollBar::handle:vertical:hover {</span>
<span class="s2">            background: rgba(255, 255, 255, 180);  /* plus lumineux au survol */</span>
<span class="s2">        }</span>
<span class="s2">        QScrollBar::add-line:vertical,</span>
<span class="s2">        QScrollBar::sub-line:vertical {</span>
<span class="s2">            height: 0px;</span>
<span class="s2">            background: none;</span>
<span class="s2">        }</span>
<span class="s2">        QScrollBar::add-page:vertical,</span>
<span class="s2">        QScrollBar::sub-page:vertical {</span>
<span class="s2">            background: none;</span>
<span class="s2">        }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">history_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>  <span class="c1"># Create a new QWidget to hold the history section</span>

        <span class="c1"># Create a layout for the history container</span>
        <span class="n">history_container_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>  <span class="c1"># Vertical layout to arrange history section widgets</span>
        <span class="n">history_container_layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Remove any margins around the layout</span>
        <span class="n">history_container_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">history_layout</span><span class="p">)</span>  <span class="c1"># Add the history layout (the grid) to the container layout</span>
        <span class="n">history_container_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  

        <span class="bp">self</span><span class="o">.</span><span class="n">history_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">history_container_layout</span><span class="p">)</span>  <span class="c1"># Assign the layout to the history widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll_area</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">history_widget</span><span class="p">)</span>  <span class="c1"># Add the history widget to the scroll area</span>

        <span class="c1"># Wrapper to better manage the history section size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_container</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>  <span class="c1"># Create a QWidget to contain the history section</span>
        <span class="n">left_container_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left_container</span><span class="p">)</span>  <span class="c1"># Vertical layout for the left container</span>
        <span class="n">left_container_layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Remove margins around the layout</span>

        <span class="c1"># Add the history label and scroll area to the layout</span>
        <span class="n">left_container_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">history_label</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>  <span class="c1"># Center align the history label</span>
        <span class="n">left_container_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scroll_area</span><span class="p">)</span>  <span class="c1"># Add the scroll area that will hold the history widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_container</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.28</span><span class="p">))</span>  <span class="c1"># Control the size of the left container based on window width</span>

        <span class="n">main_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left_container</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Add the left container to the main layout with stretch factor 1</span>
        <span class="n">main_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generated_layout</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Add the generated layout to the main layout with stretch factor 2</span>

       <span class="c1"># Center area</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">main_layout</span><span class="p">)</span>  <span class="c1"># Add the main layout to the global layout of the window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_buttons</span><span class="p">()</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">load_buttons_into_grid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">genetic_portraits</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>  <span class="c1"># Add the genetic portraits (from algorithm) to the grid</span>

        <span class="c1"># Add selected images to the history section</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="n">label</span><span class="o">.</span><span class="n">pixmap</span><span class="p">()))</span> </div>


<div class="viewcode-block" id="PortraitWorkspace.add_buttons">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.PortraitWorkspace.add_buttons">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">button_style</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QPushButton {</span>
<span class="s2">                color: white;</span>
<span class="s2">                font-size: 17px;</span>
<span class="s2">                border: 2px solid red;</span>
<span class="s2">                border-radius: 20px;</span>
<span class="s2">                padding: 5px 20px;</span>
<span class="s2">                background-color: transparent;</span>
<span class="s2">            }</span>
<span class="s2">            QPushButton:hover {</span>
<span class="s2">                background-color: rgba(255, 0, 0, 0.2);</span>
<span class="s2">            }</span>
<span class="s2">            QPushButton:disabled {</span>
<span class="s2">                color: grey;</span>
<span class="s2">                border-color: grey;</span>
<span class="s2">                background-color: #333;</span>
<span class="s2">            }</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addSpacerItem</span><span class="p">(</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Policy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Policy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">btn_combine</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;COMBINE&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_combine</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">button_style</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_combine</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_combine</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;8_bit_1_6&quot;</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_combine</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_combine</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_combine_clicked</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_combine</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">btn_generate</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;GENERATE&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_generate</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">button_style</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_generate</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_generate</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;8_bit_1_6&quot;</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_generate</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_generate</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_generate_clicked</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_generate</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">btn_finish</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;END&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_finish</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">button_style</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_finish</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_finish</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;8_bit_1_6&quot;</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_finish</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_finish_button_click</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_finish</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addSpacerItem</span><span class="p">(</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Policy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Policy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">))</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">global_layout</span><span class="o">.</span><span class="n">addSpacing</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span></div>


<div class="viewcode-block" id="PortraitWorkspace.create_image_button">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.PortraitWorkspace.create_image_button">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_image_button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">icon</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method creates a new QPushButton, sets its fixed size, assigns the provided</span>
<span class="sd">        icon to the button, and applies a style sheet to customize its appearance. </span>
<span class="sd">        The button&#39;s click event is connected to a function that handles the selection toggling.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">()</span>  <span class="c1"># Create a new QPushButton widget</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>  <span class="c1"># Set the fixed size of the button (150x150 pixels)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>  <span class="c1"># Set the button icon (QIcon passed as a parameter)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">setIconSize</span><span class="p">(</span><span class="n">btn</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>  <span class="c1"># Set the icon size to fit the button&#39;s size</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;border: 2px solid white; background-color: black;&quot;</span><span class="p">)</span>  <span class="c1"># Style the button with a white border and black background</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggle_selection</span><span class="p">(</span><span class="n">icon</span><span class="p">,</span> <span class="n">btn</span><span class="p">))</span>  <span class="c1"># Connect the button click event to toggle selection (using a lambda for simplicity)</span>
        <span class="k">return</span> <span class="n">btn</span>  <span class="c1"># Return the created button</span></div>


<div class="viewcode-block" id="PortraitWorkspace.create_selection_handler">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.PortraitWorkspace.create_selection_handler">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_selection_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">icon</span><span class="p">,</span> <span class="n">btn</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a lambda function that toggles the selection of the button when checked or unchecked.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Returns a lambda function that toggles the selection of the button when checked or unchecked</span>
        <span class="k">return</span> <span class="k">lambda</span> <span class="n">checked</span><span class="o">=</span><span class="kc">False</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggle_selection</span><span class="p">(</span><span class="n">icon</span><span class="p">,</span> <span class="n">btn</span><span class="p">)</span></div>


<div class="viewcode-block" id="PortraitWorkspace.load_buttons_into_grid">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.PortraitWorkspace.load_buttons_into_grid">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">load_buttons_into_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buttons</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads the buttons into the grid layout, removing any previous widgets.</span>

<span class="sd">        This function clears the existing widgets from the grid layout, and then loads </span>
<span class="sd">        the buttons from the `genetic_portraits` dictionary into the layout in a </span>
<span class="sd">        2-column format. After adding the buttons, it updates the state of the buttons </span>
<span class="sd">        based on the current selection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Remove any existing widgets from the layout</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generated_layout</span><span class="o">.</span><span class="n">count</span><span class="p">())):</span>  
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generated_layout</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span>  <span class="c1"># Get the widget at position i</span>
            <span class="k">if</span> <span class="n">widget</span><span class="p">:</span>
                <span class="n">widget</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># Remove the widget from the layout (detaching it)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">generated_buttons</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># Clear the list of generated buttons</span>
        
        <span class="c1"># Load the buttons from the genetic_portraits dictionary</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">btn</span><span class="p">,</span> <span class="n">icon</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">genetic_portraits</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>  
            <span class="bp">self</span><span class="o">.</span><span class="n">generated_buttons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>  <span class="c1"># Add the button to the list of generated buttons</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generated_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btn</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Add the button to the grid layout, in 2-column format</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_buttons_state</span><span class="p">()</span>  <span class="c1"># Update the state of the buttons (enable/disable based on the selection)</span></div>


<div class="viewcode-block" id="PortraitWorkspace.toggle_selection">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.PortraitWorkspace.toggle_selection">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">toggle_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">icon</span><span class="p">,</span> <span class="n">btn</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Toggles the selection state of a button (icon) and updates its appearance.</span>

<span class="sd">        If the button is already selected, it will be deselected and the border color will be reset.</span>
<span class="sd">        If the button is not selected, it will be added to the selected list, and the border color will change to red.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">btn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_buttons</span><span class="p">:</span>
            <span class="c1"># Deselect the button if it is already selected</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_buttons</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>  <span class="c1"># Remove the button from the list of selected buttons</span>
            <span class="n">btn</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;border: 2px solid white; background-color: black;&quot;</span><span class="p">)</span>  <span class="c1"># Reset the button&#39;s border color</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Select the button if it is not selected</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_buttons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>  <span class="c1"># Add the button to the list of selected buttons</span>
            <span class="n">btn</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;border: 2px solid red; background-color: black;&quot;</span><span class="p">)</span>  <span class="c1"># Change the button&#39;s border color to red</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>  <span class="c1"># Add the button to the list of selected images</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_buttons_state</span><span class="p">()</span>  <span class="c1"># Update the state of the buttons (enable/disable based on the selection)</span></div>


<div class="viewcode-block" id="PortraitWorkspace.update_buttons_state">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.PortraitWorkspace.update_buttons_state">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_buttons_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method checks the number of buttons currently selected and enables or disables</span>
<span class="sd">        the &quot;Generate&quot; and &quot;Combine&quot; buttons accordingly:</span>
<span class="sd">        - The &quot;Generate&quot; button is enabled only if exactly one button is selected.</span>
<span class="sd">        - The &quot;Combine&quot; button is enabled only if more than one button is selected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_buttons</span><span class="p">)</span>  <span class="c1"># Get the number of selected buttons</span>

        <span class="c1"># Enable the &quot;Generate&quot; button only if exactly one button is selected</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_generate</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Enable the &quot;Combine&quot; button only if more than one button is selected</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_combine</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="PortraitWorkspace.add_to_history">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.PortraitWorkspace.add_to_history">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_to_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">icon</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds an icon to the selection history if it is not already present.</span>
<span class="sd">        </span>
<span class="sd">        Compares the new icon with the existing icons in the history to avoid duplicates.</span>
<span class="sd">        If the icon is unique, a new button is created for it and added to the history layout.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            icon (QIcon): The icon representing an image to add to the history.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check if the icon is already in the history by comparing its pixmap (scaled to 60x60)</span>
        <span class="k">for</span> <span class="n">existing_icon</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_buttons</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">existing_icon</span><span class="o">.</span><span class="n">pixmap</span><span class="p">(</span><span class="n">QSize</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span><span class="o">.</span><span class="n">toImage</span><span class="p">()</span> <span class="o">==</span> <span class="n">icon</span><span class="o">.</span><span class="n">pixmap</span><span class="p">(</span><span class="n">QSize</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span><span class="o">.</span><span class="n">toImage</span><span class="p">():</span>
                <span class="k">return</span>  <span class="c1"># If the icon is already in history, do nothing</span>

        <span class="c1"># Create a new button for the icon if it&#39;s not already in history</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">()</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>  <span class="c1"># Set the icon for the button</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">setIconSize</span><span class="p">(</span><span class="n">QSize</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>  <span class="c1"># Set the icon size to 60x60</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">70</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>  <span class="c1"># Set the button size to 70x70</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;border: 2px solid white; background-color: black;&quot;</span><span class="p">)</span>  <span class="c1"># Style the button</span>

        <span class="c1"># Connect the button&#39;s click event to the toggle_selection function</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggle_selection</span><span class="p">(</span><span class="n">icon</span><span class="p">,</span> <span class="n">btn</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_buttons</span><span class="p">[</span><span class="n">icon</span><span class="p">]</span> <span class="o">=</span> <span class="n">btn</span>
        <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">history_buttons</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># Calculate the row and column for placing the button in the history layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btn</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span> <span class="c1"># Add the button to the history layout</span></div>


<div class="viewcode-block" id="PortraitWorkspace.reset_selection_styles">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.PortraitWorkspace.reset_selection_styles">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">reset_selection_styles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         Deselects all selected buttons and resets their style to the default.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Deselect all the generated buttons and reset their styles to default</span>
        <span class="k">for</span> <span class="n">btn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">generated_buttons</span><span class="p">:</span>
            <span class="n">btn</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;border: 2px solid white; background-color: black;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_buttons</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="c1"># Deselect all the history buttons and reset their styles to default</span>
        <span class="k">for</span> <span class="n">btn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_buttons</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">btn</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;border: 2px solid white; background-color: black;&quot;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="PortraitWorkspace.get_selected_image_paths">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.PortraitWorkspace.get_selected_image_paths">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_selected_image_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method goes through the list of selected buttons and extracts the </span>
<span class="sd">        associated image paths. If the button has an &#39;image_path&#39; attribute, </span>
<span class="sd">        it appends the path to the list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># List to store the paths of the selected images</span>
        <span class="k">for</span> <span class="n">btn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_buttons</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">btn</span><span class="p">,</span> <span class="s1">&#39;image_path&#39;</span><span class="p">):</span>
                <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">btn</span><span class="o">.</span><span class="n">image_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">paths</span></div>


<div class="viewcode-block" id="PortraitWorkspace.on_generate_clicked">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.PortraitWorkspace.on_generate_clicked">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_generate_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles the click event of the &quot;Generate&quot; button.</span>

<span class="sd">        This method checks if exactly one image button is selected. If so, it calls the `generate_img` function with the selected image&#39;s path, adds</span>
<span class="sd">        the image to the history, and resets the selection styles.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_buttons</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># If the number of selected buttons is not exactly 1, do nothing</span>
            <span class="k">return</span>
        
        <span class="c1"># Call the generate_img function with the image paths</span>
        <span class="n">image_paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_selected_image_paths</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">image_paths</span><span class="p">:</span>
            <span class="n">share</span><span class="o">.</span><span class="n">generate_img</span><span class="p">(</span><span class="n">image_paths</span><span class="p">)</span>

        <span class="n">selected_btn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_buttons</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Get the selected button</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genetic_portraits</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">selected_btn</span><span class="p">)</span>  <span class="c1"># Get the icon associated with the selected button</span>
        <span class="k">if</span> <span class="n">icon</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>  <span class="c1"># Add the selected image to the history</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">genetic_portraits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_last_images</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tmp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_buttons_into_grid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">genetic_portraits</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_selection_styles</span><span class="p">()</span> <span class="c1"># Reset the selection styles (deselect the images)</span></div>


<div class="viewcode-block" id="PortraitWorkspace.on_combine_clicked">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.PortraitWorkspace.on_combine_clicked">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_combine_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles the click event of the &quot;Combine&quot; button.</span>

<span class="sd">        This method checks if at least two image buttons are selected. If so, it  calls the `combine_img` function with the paths of the selected images,</span>
<span class="sd">        adds each selected image to the history, and resets the selection styles.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_buttons</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span> <span class="c1"># If less than 2 buttons are selected, do nothing</span>
            <span class="k">return</span>
        
        <span class="c1"># Get the paths of the selected images</span>
        <span class="n">image_paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_selected_image_paths</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">image_paths</span><span class="p">:</span>
            <span class="n">share</span><span class="o">.</span><span class="n">combine_img</span><span class="p">(</span><span class="n">image_paths</span><span class="p">)</span>

        <span class="c1"># Add each selected image to the history</span>
        <span class="k">for</span> <span class="n">btn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_buttons</span><span class="p">:</span>
            <span class="n">icon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genetic_portraits</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">icon</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_to_history</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">genetic_portraits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_last_images</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tmp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_buttons_into_grid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">genetic_portraits</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_selection_styles</span><span class="p">()</span> <span class="c1"># Reset the selection styles (deselect the images)</span></div>


<div class="viewcode-block" id="PortraitWorkspace.on_finish_button_click">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.PortraitWorkspace.on_finish_button_click">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_finish_button_click</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles the click event of the &quot;Finish&quot; button.</span>

<span class="sd">        This method converts each selected QPushButton from the `selected_images` list into a QLabel containing the corresponding image. Then, it passes</span>
<span class="sd">        these labels to the `FinalScreen` to display them.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selected_images_2</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># New list to hold QLabel objects</span>

        <span class="c1"># Convert each QPushButton into a QLabel</span>
        <span class="k">for</span> <span class="n">button</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="p">:</span>  <span class="c1"># self.selected_images contains QPushButton objects</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">button</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">):</span>  <span class="c1"># Check if the item is a QPushButton</span>
                <span class="n">pixmap</span> <span class="o">=</span> <span class="n">button</span><span class="o">.</span><span class="n">icon</span><span class="p">()</span><span class="o">.</span><span class="n">pixmap</span><span class="p">(</span><span class="n">button</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>  <span class="c1"># Get the QPixmap of the button&#39;s icon</span>
                <span class="k">if</span> <span class="n">pixmap</span><span class="p">:</span>
                    <span class="c1"># Create a QLabel with the image</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>
                    <span class="n">label</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">pixmap</span><span class="p">)</span>  <span class="c1"># Set the image to the QLabel</span>
                    <span class="n">selected_images_2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>  <span class="c1"># Add the QLabel to the new list</span>

        <span class="c1"># Now pass the selected_images_2 (containing QLabels) to FinalScreen</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_screen</span> <span class="o">=</span> <span class="n">FinalScreen</span><span class="p">(</span><span class="n">selected_images_2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_buttons</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_screen</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  </div>
</div>



<span class="c1">##### FINAL SCREEN ##### </span>
<div class="viewcode-block" id="FinalScreen">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.FinalScreen">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">FinalScreen</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A screen displayed after completing the portrait generation process.</span>

<span class="sd">    This class shows a &quot;Well Done!&quot; message, the last selected portrait image, and buttons for downloading the image, downloading the history, and showing the history.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        selected_images (list): List of selected images (QLabel objects) to be displayed.</span>
<span class="sd">        history_buttons (dict): Dictionary of historical buttons (QPushButton objects).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected_images_2</span><span class="p">,</span> <span class="n">history_buttons</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the FinalScreen with the selected images and history buttons.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span> <span class="o">=</span> <span class="n">selected_images_2</span>  <span class="c1"># List of selected images (QLabel objects)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_buttons</span> <span class="o">=</span> <span class="n">history_buttons</span>  <span class="c1"># Dictionary of historical buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Well Done&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>  <span class="c1"># Set the window size and position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: black;&quot;</span><span class="p">)</span>  <span class="c1"># Set the background to black</span>
    
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

       <span class="c1"># &quot;Well Done!&quot; Title with Neon Effect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Well Done!&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Press Start 2P&quot;</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="n">QFont</span><span class="o">.</span><span class="n">Weight</span><span class="o">.</span><span class="n">Bold</span><span class="p">))</span>  <span class="c1"># Font and size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: white; background: transparent; border: none;&quot;</span><span class="p">)</span>  <span class="c1"># White text color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setFixedHeight</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>  <span class="c1"># Reduced height for the label area</span>
        
        <span class="c1"># Neon effect using QGraphicsDropShadowEffect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shadow</span> <span class="o">=</span> <span class="n">QGraphicsDropShadowEffect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shadow</span><span class="o">.</span><span class="n">setBlurRadius</span><span class="p">(</span><span class="mi">70</span><span class="p">)</span>  <span class="c1"># Width of the neon effect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shadow</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>  <span class="c1"># White neon color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shadow</span><span class="o">.</span><span class="n">setOffset</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># No offset, just the glow around</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setGraphicsEffect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shadow</span><span class="p">)</span>  <span class="c1"># Apply the shadow effect</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>

        <span class="c1"># Image: Retrieve the last selected image (the last in the list)</span>
        <span class="n">last_image_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Last QLabel in the list</span>
        <span class="n">pixmap</span> <span class="o">=</span> <span class="n">last_image_label</span><span class="o">.</span><span class="n">pixmap</span><span class="p">()</span>  <span class="c1"># Get the pixmap from the QLabel</span>

        <span class="c1"># If the pixmap is valid (not null), resize it</span>
        <span class="k">if</span> <span class="n">pixmap</span><span class="p">:</span>
            <span class="c1"># Resize the image to make it larger</span>
            <span class="n">scaled_pixmap</span> <span class="o">=</span> <span class="n">pixmap</span><span class="o">.</span><span class="n">scaled</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AspectRatioMode</span><span class="o">.</span><span class="n">KeepAspectRatio</span><span class="p">)</span>  <span class="c1"># Scale the image to 300x300 while keeping the aspect ratio</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">image_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># Create a QLabel to display the image</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">image_label</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">scaled_pixmap</span><span class="p">)</span>  <span class="c1"># Apply the scaled image to the label</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">image_label</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>  <span class="c1"># Center the image within the label</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_label</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>  <span class="c1"># Add the image to the layout</span>

            <span class="c1"># Create a neon flashing frame around the image</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_neon_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_label</span><span class="p">)</span>
           
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Erreur&quot;</span><span class="p">)</span>  
        
        <span class="c1"># Add buttons to the interface with the same style as the other screens</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_buttons</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
    
<div class="viewcode-block" id="FinalScreen.create_neon_frame">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.FinalScreen.create_neon_frame">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_neon_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_label</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a neon flashing frame around the image.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">neon_effect</span> <span class="o">=</span> <span class="n">QGraphicsDropShadowEffect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neon_effect</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># Red color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neon_effect</span><span class="o">.</span><span class="n">setBlurRadius</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># Blur radius for the frame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neon_effect</span><span class="o">.</span><span class="n">setOffset</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  

        <span class="c1"># Apply the effect to the label containing the image</span>
        <span class="n">image_label</span><span class="o">.</span><span class="n">setGraphicsEffect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neon_effect</span><span class="p">)</span>

        <span class="c1"># Create a timer to make the frame flash</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neon_timer</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neon_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_neon_effect</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">neon_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>  <span class="c1"># The frame flashes every 500 ms (0.5 second)</span></div>


<div class="viewcode-block" id="FinalScreen.toggle_neon_effect">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.FinalScreen.toggle_neon_effect">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">toggle_neon_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Toggles the visibility of the neon frame to make it flash.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">neon_effect</span><span class="o">.</span><span class="n">isEnabled</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">neon_effect</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Disable the frame effect</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">neon_effect</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Enable the frame effect</span></div>


<div class="viewcode-block" id="FinalScreen.add_buttons">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.FinalScreen.add_buttons">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layout</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds the buttons for downloading the image, downloading the history, </span>
<span class="sd">        and showing the history to the layout.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">button_style</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            QPushButton {</span>
<span class="s2">                color: white;</span>
<span class="s2">                font-size: 17px;</span>
<span class="s2">                border: 2px solid red;</span>
<span class="s2">                border-radius: 20px;</span>
<span class="s2">                padding: 5px 20px;</span>
<span class="s2">                background-color: transparent;</span>
<span class="s2">            }</span>
<span class="s2">            QPushButton:hover {</span>
<span class="s2">                background-color: rgba(255, 0, 0, 0.2);</span>
<span class="s2">            }</span>
<span class="s2">            QPushButton:disabled {</span>
<span class="s2">                color: grey;</span>
<span class="s2">                border-color: grey;</span>
<span class="s2">                background-color: #333;</span>
<span class="s2">            }</span>
<span class="s2">        &quot;&quot;&quot;</span>

        <span class="n">button_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>

        <span class="n">button_layout</span><span class="o">.</span><span class="n">addSpacerItem</span><span class="p">(</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Policy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Policy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">))</span>

        <span class="c1"># &quot;Download this image&quot; button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_image_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Download image&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_image_button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">button_style</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_image_button</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_image_button</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;8_bit_1_6&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_image_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Active le bouton selon ton besoin</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">download_image_button</span><span class="p">)</span>

        <span class="c1"># &quot;Download the whole history&quot; button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_history_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Download history&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_history_button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">button_style</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_history_button</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_history_button</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;8_bit_1_6&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_history_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Active le bouton selon ton besoin</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">download_history_button</span><span class="p">)</span>

        <span class="c1"># &quot;Show the whole history&quot; button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_history_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Show history&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_history_button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">button_style</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_history_button</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_history_button</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;8_bit_1_6&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_history_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Active le bouton selon ton besoin</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_history_button</span><span class="p">)</span>

        <span class="c1"># Connect the buttons to their respective actions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_image_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">download_image</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_history_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">download_history</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_history_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_history</span><span class="p">)</span>

        <span class="c1"># Spacer after the buttons to center them</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addSpacerItem</span><span class="p">(</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Policy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Policy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">))</span>

        <span class="c1"># Add the buttons to the main window</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">button_layout</span><span class="p">)</span></div>


<div class="viewcode-block" id="FinalScreen.download_history">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.FinalScreen.download_history">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">download_history</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Downloads all images from the history into a folder named &#39;history&#39;.</span>
<span class="sd">        Opens a file dialog for the user to select the download directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Open a dialog to choose the folder</span>
        <span class="n">folder_path</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Select Download Directory&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">folder_path</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No folder selected.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;Download canceled.&quot;</span>

        <span class="c1"># Create a &quot;history&quot; subfolder in the selected directory</span>
        <span class="n">history_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_path</span><span class="p">,</span> <span class="s2">&quot;history&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">history_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Loop through all history buttons</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">button</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">history_buttons</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">pixmap</span> <span class="o">=</span> <span class="n">button</span><span class="o">.</span><span class="n">icon</span><span class="p">()</span><span class="o">.</span><span class="n">pixmap</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>  <span class="c1"># Get the pixmap of the button&#39;s icon</span>

            <span class="k">if</span> <span class="n">pixmap</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">pixmap</span><span class="o">.</span><span class="n">isNull</span><span class="p">():</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;image_</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">.png&quot;</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">history_folder</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">pixmap</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Image saved: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error saving </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No valid pixmap for button </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Images saved in: </span><span class="si">{</span><span class="n">history_folder</span><span class="si">}</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="FinalScreen.show_history">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.FinalScreen.show_history">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">show_history</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Displays the history of portraits as a grid of buttons.</span>
<span class="sd">        Creates a grid layout to display all the historical buttons.</span>
<span class="sd">        &quot;&quot;&quot;</span>
       <span class="c1"># Create a grid layout for the history</span>
        <span class="n">history_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>  <span class="c1"># Main layout to contain the title + grid</span>
        <span class="n">history_layout</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

        <span class="c1"># &quot;History&quot; title</span>
        <span class="n">history_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;History&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">history_label</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Press Start 2P&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">QFont</span><span class="o">.</span><span class="n">Weight</span><span class="o">.</span><span class="n">Bold</span><span class="p">))</span>
        <span class="n">history_label</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignmentFlag</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
        <span class="n">history_label</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color: white; background: transparent;&quot;</span><span class="p">)</span>
        <span class="n">history_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">history_label</span><span class="p">)</span>

        <span class="c1"># Grid of buttons</span>
        <span class="n">grid_layout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>
        <span class="n">grid_layout</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Space between buttons</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="mi">8</span>  <span class="c1"># Number of columns in the grid</span>
        <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">btn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">history_buttons</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="n">grid_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btn</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
            <span class="n">col</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">col</span> <span class="o">&gt;=</span> <span class="n">columns</span><span class="p">:</span>
                <span class="n">col</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">history_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">grid_layout</span><span class="p">)</span>  <span class="c1"># Add the grid to the main layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">history_layout</span><span class="p">)</span>  <span class="c1"># Add everything to the window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_history_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Disable the button to avoid duplicates</span></div>


<div class="viewcode-block" id="FinalScreen.download_image">
<a class="viewcode-back" href="../../main_interface_graphique.html#interface_graphique.main_interface_graphique.FinalScreen.download_image">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">download_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Downloads the last selected image as &#39;selected portrait&#39;.</span>

<span class="sd">        Opens a file dialog to allow the user to choose where to save the image.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Open a file dialog to allow the user to choose where to save the image</span>
        <span class="n">file_dialog</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">file_dialog</span><span class="o">.</span><span class="n">setFileMode</span><span class="p">(</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">FileMode</span><span class="o">.</span><span class="n">AnyFile</span><span class="p">)</span>  <span class="c1"># Allow selecting any file</span>
        <span class="n">file_dialog</span><span class="o">.</span><span class="n">setNameFilter</span><span class="p">(</span><span class="s2">&quot;Images (*.png *.xpm *.jpg)&quot;</span><span class="p">)</span>  <span class="c1"># Filter for image files</span>
        <span class="n">file_dialog</span><span class="o">.</span><span class="n">setViewMode</span><span class="p">(</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">ViewMode</span><span class="o">.</span><span class="n">List</span><span class="p">)</span>  <span class="c1"># List view for file selection</span>

        <span class="c1"># Default file name for the save</span>
        <span class="n">default_file_name</span> <span class="o">=</span> <span class="s2">&quot;selected portrait.png&quot;</span>
        <span class="n">file_dialog</span><span class="o">.</span><span class="n">selectFile</span><span class="p">(</span><span class="n">default_file_name</span><span class="p">)</span>  <span class="c1"># Set the default file name in the dialog</span>

        <span class="k">if</span> <span class="n">file_dialog</span><span class="o">.</span><span class="n">exec</span><span class="p">():</span>  <span class="c1"># If the user has selected a file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">file_dialog</span><span class="o">.</span><span class="n">selectedFiles</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Get the selected file path</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected path: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Debugging message showing the selected path</span>
            
            <span class="n">last_image_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_images</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Get the last selected image</span>
            <span class="n">pixmap</span> <span class="o">=</span> <span class="n">last_image_label</span><span class="o">.</span><span class="n">pixmap</span><span class="p">()</span>  <span class="c1"># Get the pixmap of the last image</span>

            <span class="k">if</span> <span class="n">pixmap</span><span class="p">:</span>  <span class="c1"># If the pixmap is valid</span>
                <span class="c1"># Check the file format</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">file_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="s1">&#39;.xpm&#39;</span><span class="p">,</span> <span class="s1">&#39;.jpg&#39;</span><span class="p">)):</span>  <span class="c1"># If the file format is incorrect</span>
                    <span class="n">file_path</span> <span class="o">+=</span> <span class="s1">&#39;.png&#39;</span>  <span class="c1"># Add .png extension if not specified</span>

                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trying to save the image at </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Debugging message before saving</span>
                
                <span class="n">saved</span> <span class="o">=</span> <span class="n">pixmap</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>  <span class="c1"># Save the image to the chosen location</span>
                
                <span class="k">if</span> <span class="n">saved</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Image saved at </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Success message</span>
                    <span class="k">return</span> <span class="s2">&quot;Image saved successfully!&quot;</span>  <span class="c1"># Return a success message</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error saving the image: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Error message</span>
                    <span class="k">return</span> <span class="s2">&quot;Error saving the image.&quot;</span>  <span class="c1"># Return an error message</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No image to save!&quot;</span><span class="p">)</span>  <span class="c1"># Error message if no image is available</span>
                <span class="k">return</span> <span class="s2">&quot;No image to save!&quot;</span>  <span class="c1"># Return an error message</span></div>
</div>




<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="n">window</span> <span class="o">=</span> <span class="n">WelcomeScreen</span><span class="p">()</span>
    <span class="n">window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec</span><span class="p">())</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Droits d'auteur 2025, Elisa Afonso, Maële Bedel, Hieu Minh Dang, Lilian Guitart Arnau, Gautier Dupont--Burette, Laura Forestier.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>